{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 800,
  "height": 600,
  "title": "World Happiness Report 2022",
  "data": {
    "url": "https://github.com/huimingj/3179/blob/main/assignment2/data/2022.csv"
  },
  "params": [
    {
      "name": "Happiness Score_Above",
      "value": 0,
      "bind": {
        "input": "range",
        "min": 2,
        "max": 8,
        "step": 0.1,
        "name": "Minimum Happiness Score: "
      }
    },
    {
      "name": "Region_selection",
      "bind": {
        "input": "select",
        "options": [
          null,
          "Western Europe",
          "Middle East and North Africa",
          "North America and ANZ",
          "Central and Eastern Europe",
          "Middle East and North Africa",
          "Latin America and Caribbean",
          "East Asia",
          "Southeast Asia",
          "Sub-Saharan Africa"
          
        ],
        "labels": [
          "Show All",
          "Western Europe",
          "Middle East and North Africa",
          "North America and ANZ",
          "Central and Eastern Europe",
          "Middle East and North Africa",
          "Latin America and Caribbean",
          "East Asia",
          "Southeast Asia",
          "Sub-Saharan Africa"
        ],
        "name": "Region Selection: "
      }
    }
  ],
  "transform": [
    {"filter": "datum.Happiness Score > Happiness Score_Above"},
    {
      "filter": "Region_selection == null || datum.Region == Region_selection"
    }
  ],
  "encoding": {
    "x": {
      "field": "GDP",
      "type": "quantitative",
      "title": "GDP",
      "axis": {"tickCount": 7}
    },
    "y": {
      "field": "Social Support",
      "type": "quantitative",
      "axis": {"tickCount": 6}

    }
  },
  "layer": [
    {
      "mark": "circle",
      "encoding": {
        "size": {
          "field": "Happiness Score",
          "type": "quantitative",
          "scale": {
            "type": "threshold",
            "domain": [2, 3.5, 5, 6.5, 8],
            "range": [10, 50, 150, 200, 300, 400]
          },

        },
        "color": {
          "field": "Region",
          "type": "nominal",
          "scale": {
            "domain": [
              "Western Europe",
              "Middle East and North Africa",
              "North America and ANZ",
              "Central and Eastern Europe",
              "Middle East and North Africa",
              "Latin America and Caribbean",
              "East Asia",
              "Southeast Asia",
              "Sub-Saharan Africa"
            ],
            "range": [
              "#a6cee3",
              "#1f78b4",
              "#b2df8a",
              "#33a02c",
              "#fb9a99",
              "#e31a1c",
              "#fdbf6f",
              "#ff7f00",
              "#cab2d6"
            ]
          }
        },
        "opacity": {"value": 0.5},
        "tooltip": [
          {"field": "Country", "type": "nominal"},
          {"field": "GDP", "type": "quantitative", "format": ","},
          {"field": "Social Support", "type": "quantitative", "format": ","},
          {"field": "Freedom", "type": "quantitative", "format": ","},
          {"field": "Life Expectancy", "type": "quantitative", "format": ","},
        ]
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "right",
        "baseline": "middle",
        "dx": -12,
        "fontSize": 11.5,
        "fontStyle": "italic"
      },
      "encoding": {
        "text": {"field": "Country", "type": "nominal"},
        "color": {"value": "black"},
        "opacity": {
          "condition": {
            "test": "datum['Country'] == 'China' || datum['Country'] == 'Singapore' || datum['Country'] == 'Australia' || datum['Country'] == 'New Zealand' || datum['Country'] == 'Italy' || datum['Country'] == 'Yemen' ||  datum['Country'] == 'United States'",
            "value": 1
          },
          "value": 0
        },
        "tooltip": [
          {"field": "Country", "type": "nominal"},
          {"field": "GDP", "type": "quantitative", "format": ","},
          {"field": "Social Support", "type": "quantitative", "format": ","},
          {"field": "Freedom", "type": "quantitative", "format": ","},
          {"field": "Life Expectancy", "type": "quantitative", "format": ","},

        ]
      }
    }
  ]
}
